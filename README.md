# XIVIX AI Core V2.0

> **Gemini 2.5 Flash ê¸°ë°˜ ì´ˆê³ ì† AI ìƒë‹´ ìë™í™” ì—”ì§„**
> 
> **Zero-Touch Onboarding & Extreme Speed**

<p align="center">
  <img src="https://img.shields.io/badge/Engine-Gemini%202.5%20Flash-blue?style=for-the-badge" alt="Gemini">
  <img src="https://img.shields.io/badge/Framework-Hono-orange?style=for-the-badge" alt="Hono">
  <img src="https://img.shields.io/badge/Platform-Cloudflare-yellow?style=for-the-badge" alt="Cloudflare">
  <img src="https://img.shields.io/badge/Version-2.0.0-green?style=for-the-badge" alt="Version">
</p>

---

## ğŸŒ ì„œë¹„ìŠ¤ URL (í”„ë¡œë•ì…˜)

| ì„œë¹„ìŠ¤ | URL | ì„¤ëª… |
|--------|-----|------|
| **ğŸ  ë©”ì¸ í˜ì´ì§€** | https://xivix-ai-core.pages.dev | ëœë”© í˜ì´ì§€ |
| **ğŸ”‘ ë¡œê·¸ì¸** | https://xivix-ai-core.pages.dev/login | **ë§ˆìŠ¤í„°/ì‚¬ì¥ë‹˜ ë¡œê·¸ì¸** |
| **ğŸ”— ê³ ê° ì—°ë™ í˜ì´ì§€** | https://xivix-ai-core.pages.dev/connect | **ì‚¬ì¥ë‹˜ 30ì´ˆ ì—°ë™** |
| **ğŸ‘‘ ë§ˆìŠ¤í„° ëŒ€ì‹œë³´ë“œ** | https://xivix-ai-core.pages.dev/master | **ë°©ëŒ€í‘œë‹˜ ì „ìš© ê´€ë¦¬** |
| **ğŸ“Š ëŒ€ì‹œë³´ë“œ** | https://xivix-ai-core.pages.dev/dashboard | ë§¤ì¥ë³„ í†µê³„ |
| **ğŸ”— ë„¤ì´ë²„ Webhook** | https://xivix-ai-core.pages.dev/v1/naver/callback/{storeId} | í†¡í†¡ ë©”ì‹œì§€ ìˆ˜ì‹  |
| **â¤ï¸ í—¬ìŠ¤ì²´í¬** | https://xivix-ai-core.pages.dev/api/system/health | ì‹œìŠ¤í…œ ìƒíƒœ |

---

## ğŸ†• V2.0 ì‹ ê·œ ê¸°ëŠ¥

### âœ… ì¸ì¦ ì‹œìŠ¤í…œ (ì™„ë£Œ)
- **ë§ˆìŠ¤í„° ë¡œê·¸ì¸**: ë§ˆìŠ¤í„° ê³„ì • ì „ìš© ì¸ì¦
- **ì‚¬ì¥ë‹˜ ë¡œê·¸ì¸**: ë§¤ì¥ ì‚¬ì¥ë‹˜ ì¸ì¦
- **ì„¸ì…˜ ê´€ë¦¬**: ì„œë²„ì‚¬ì´ë“œ ì„¸ì…˜ ê¸°ë°˜
- **ë¡œê·¸ì¸ ë³´ì•ˆ**: 5íšŒ ì‹¤íŒ¨ ì‹œ 30ë¶„ ê³„ì • ì ê¸ˆ

### âœ… ë„¤ì´ë²„ í†¡í†¡ API ì—°ë™ (ì™„ë£Œ)
- **í…ìŠ¤íŠ¸ ë©”ì‹œì§€ ë°œì†¡**: ìë™ AI ì‘ë‹µ ë°œì†¡
- **ë²„íŠ¼ ë©”ì‹œì§€ ë°œì†¡**: ì˜ˆì•½ ìœ ë„ ë²„íŠ¼
- **ë³µí•© ë©”ì‹œì§€**: ì´ë¯¸ì§€ + ë²„íŠ¼ ì¡°í•©
- **í…ŒìŠ¤íŠ¸ ëª¨ë“œ**: IS_TEST_MODE=true ì‹œ ì‹¤ì œ ë°œì†¡ ì°¨ë‹¨

### âœ… ì˜ˆì•½ ì•Œë¦¼ ë¦¬ë§ˆì¸ë” (ì™„ë£Œ)
- **ìë™ ìŠ¤ì¼€ì¤„ë§**: ì˜ˆì•½ í™•ì • ì‹œ 24h/2h/1h ì „ ì•Œë¦¼ ìë™ ìƒì„±
- **ì¼ê´„ ë°œì†¡**: Cron Jobìœ¼ë¡œ ëŒ€ê¸° ì•Œë¦¼ ì¼ê´„ ì²˜ë¦¬
- **ì·¨ì†Œ ì—°ë™**: ì˜ˆì•½ ì·¨ì†Œ ì‹œ ë¦¬ë§ˆì¸ë” ìë™ ì·¨ì†Œ

### âœ… ì›”ê°„ ìˆ˜ìµ ë¦¬í¬íŠ¸ (ì™„ë£Œ)
- **ìë™ í†µê³„ ì§‘ê³„**: ëŒ€í™” ìˆ˜, ì˜ˆì•½ ìˆ˜, ì „í™˜ìœ¨
- **ê³ ê° ë¶„ì„**: ì´ ê³ ê°, ì¬ë°©ë¬¸ ê³ ê°
- **ì‹œê°„ëŒ€ ë¶„ì„**: í”¼í¬ ì‹œê°„ëŒ€ íŒŒì•…
- **ì¸ê¸° ì„œë¹„ìŠ¤**: ì˜ˆì•½ ê¸°ì¤€ ì¸ê¸° ì„œë¹„ìŠ¤ TOP 10

---

## ğŸ“¡ V2.0 API ì—”ë“œí¬ì¸íŠ¸

### ì¸ì¦ API

```bash
# ë§ˆìŠ¤í„° ë¡œê·¸ì¸
curl -X POST https://xivix-ai-core.pages.dev/api/auth/master/login \
  -H "Content-Type: application/json" \
  -d '{"email":"master@xivix.kr","password":"your-password"}'

# ì‚¬ì¥ë‹˜ ë¡œê·¸ì¸
curl -X POST https://xivix-ai-core.pages.dev/api/auth/owner/login \
  -H "Content-Type: application/json" \
  -d '{"email":"owner@example.com","password":"your-password"}'

# ë¡œê·¸ì•„ì›ƒ
curl -X POST https://xivix-ai-core.pages.dev/api/auth/logout \
  -H "Authorization: Bearer {token}"

# ì„¸ì…˜ ê²€ì¦
curl https://xivix-ai-core.pages.dev/api/auth/verify \
  -H "Authorization: Bearer {token}"

# í˜„ì¬ ì‚¬ìš©ì ì •ë³´
curl https://xivix-ai-core.pages.dev/api/auth/me \
  -H "Authorization: Bearer {token}"

# ë¹„ë°€ë²ˆí˜¸ ë³€ê²½
curl -X POST https://xivix-ai-core.pages.dev/api/auth/change-password \
  -H "Authorization: Bearer {token}" \
  -H "Content-Type: application/json" \
  -d '{"oldPassword":"current","newPassword":"new-password"}'
```

### ì˜ˆì•½ ì•Œë¦¼ ë¦¬ë§ˆì¸ë” API

```bash
# ëŒ€ê¸° ì¤‘ì¸ ë¦¬ë§ˆì¸ë” ì¡°íšŒ
curl https://xivix-ai-core.pages.dev/api/reminders/pending

# ë¦¬ë§ˆì¸ë” ì¼ê´„ ì²˜ë¦¬ (Cron Jobìš©)
curl -X POST https://xivix-ai-core.pages.dev/api/reminders/process

# ë§¤ì¥ë³„ ë¦¬ë§ˆì¸ë” í†µê³„
curl https://xivix-ai-core.pages.dev/api/reminders/stats/1

# ì˜ˆì•½ í™•ì • + ë¦¬ë§ˆì¸ë” ìƒì„±
curl -X POST https://xivix-ai-core.pages.dev/api/reservations/1/confirm-with-reminder

# ì˜ˆì•½ ì·¨ì†Œ + ë¦¬ë§ˆì¸ë” ì·¨ì†Œ
curl -X POST https://xivix-ai-core.pages.dev/api/reservations/1/cancel
```

### ì›”ê°„ ë¦¬í¬íŠ¸ API

```bash
# ì›”ê°„ ë¦¬í¬íŠ¸ ìƒì„±
curl -X POST https://xivix-ai-core.pages.dev/api/reports/monthly/1 \
  -H "Content-Type: application/json" \
  -d '{"month":"2026-01"}'

# ì›”ê°„ ë¦¬í¬íŠ¸ ì¡°íšŒ
curl "https://xivix-ai-core.pages.dev/api/reports/monthly/1?month=2026-01"

# ìµœê·¼ 12ê°œì›” ë¦¬í¬íŠ¸
curl https://xivix-ai-core.pages.dev/api/reports/monthly/1

# ì „ì²´ ë§¤ì¥ ë¦¬í¬íŠ¸ ìƒì„± (ë§ˆìŠ¤í„°ìš©)
curl -X POST https://xivix-ai-core.pages.dev/api/reports/generate-all \
  -H "Content-Type: application/json" \
  -d '{"month":"2026-01"}'
```

---

## ğŸ“ í”„ë¡œì íŠ¸ êµ¬ì¡° (V2.0)

```
/home/user/webapp/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ index.tsx              # ë©”ì¸ ì•± ì—”íŠ¸ë¦¬ (ë¼ìš°íŒ…)
â”‚   â”œâ”€â”€ types.ts               # TypeScript íƒ€ì… ì •ì˜
â”‚   â”œâ”€â”€ routes/
â”‚   â”‚   â”œâ”€â”€ api.ts             # REST API ì—”ë“œí¬ì¸íŠ¸ (4600+ ì¤„)
â”‚   â”‚   â””â”€â”€ webhook.ts         # ë„¤ì´ë²„ í†¡í†¡ ì›¹í›… í•¸ë“¤ëŸ¬
â”‚   â”œâ”€â”€ views/
â”‚   â”‚   â”œâ”€â”€ super-master.tsx   # ë§ˆìŠ¤í„° ëŒ€ì‹œë³´ë“œ V2.0
â”‚   â”‚   â”œâ”€â”€ client-onboarding.tsx  # ì‚¬ì¥ë‹˜ ì—°ë™ í˜ì´ì§€
â”‚   â”‚   â”œâ”€â”€ dashboard.tsx      # ë§¤ì¥ ëŒ€ì‹œë³´ë“œ
â”‚   â”‚   â””â”€â”€ login.tsx          # ë¡œê·¸ì¸ í˜ì´ì§€ V2.0
â”‚   â””â”€â”€ lib/
â”‚       â”œâ”€â”€ auth.ts            # ì¸ì¦ ë¼ì´ë¸ŒëŸ¬ë¦¬ (V2.0 ì‹ ê·œ)
â”‚       â”œâ”€â”€ naver-talktalk.ts  # í†¡í†¡ API í´ë¼ì´ì–¸íŠ¸ (V2.0 ê°•í™”)
â”‚       â”œâ”€â”€ reminder.ts        # ì˜ˆì•½ ì•Œë¦¼ ë¦¬ë§ˆì¸ë” (V2.0 ì‹ ê·œ)
â”‚       â”œâ”€â”€ gemini.ts          # Gemini AI ì—°ë™
â”‚       â”œâ”€â”€ kv-context.ts      # KV ìºì‹œ ìœ í‹¸
â”‚       â””â”€â”€ r2-storage.ts      # R2 ì´ë¯¸ì§€ ì €ì¥ ìœ í‹¸
â”œâ”€â”€ migrations/
â”‚   â”œâ”€â”€ 0001_initial_schema.sql
â”‚   â”œâ”€â”€ 0002_xivix_tables.sql
â”‚   â”œâ”€â”€ ...
â”‚   â””â”€â”€ 0010_auth_system.sql   # V2.0 ì¸ì¦/ë¦¬ë§ˆì¸ë”/ë¦¬í¬íŠ¸ í…Œì´ë¸”
â”œâ”€â”€ wrangler.jsonc
â”œâ”€â”€ vite.config.ts
â”œâ”€â”€ package.json
â””â”€â”€ ecosystem.config.cjs       # PM2 ì„¤ì • (ë¡œì»¬ ê°œë°œìš©)
```

---

## ğŸ—„ï¸ ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ (V2.0 ì¶”ê°€)

### xivix_master_accounts (ë§ˆìŠ¤í„° ê³„ì •)
```sql
id, email, name, phone, password_hash, is_active, last_login_at
```

### xivix_sessions (ì„¸ì…˜ ê´€ë¦¬)
```sql
id, session_token, user_type, user_id, ip_address, user_agent, expires_at
```

### xivix_auth_logs (ì¸ì¦ ë¡œê·¸)
```sql
id, user_type, user_id, action, ip_address, user_agent, details
```

### xivix_reminder_schedules (ë¦¬ë§ˆì¸ë” ìŠ¤ì¼€ì¤„)
```sql
id, store_id, reservation_id, reminder_type, scheduled_at, sent_at, status
```

### xivix_monthly_reports (ì›”ê°„ ë¦¬í¬íŠ¸)
```sql
id, store_id, report_month, total_conversations, total_reservations,
confirmed_reservations, cancelled_reservations, conversion_rate,
avg_response_time_ms, total_customers, returning_customers, peak_hours, popular_services
```

### xivix_naver_talktalk_config (í†¡í†¡ API ì„¤ì •)
```sql
id, store_id, partner_id, account_id, access_token, webhook_verified
```

---

## âœ… êµ¬í˜„ ì™„ë£Œ ê¸°ëŠ¥

### V2.0 (2026-02-02)
- [x] ë§ˆìŠ¤í„°/ì‚¬ì¥ë‹˜ ë¡œê·¸ì¸ ì¸ì¦ ì‹œìŠ¤í…œ
- [x] ì„œë²„ì‚¬ì´ë“œ ì„¸ì…˜ ê´€ë¦¬
- [x] ë„¤ì´ë²„ í†¡í†¡ ë©”ì‹œì§€ ë°œì†¡ API
- [x] ì˜ˆì•½ ì•Œë¦¼ ìë™ ë°œì†¡ (ë¦¬ë§ˆì¸ë”)
- [x] ì›”ê°„ ìˆ˜ìµ ë¦¬í¬íŠ¸ ìƒì„±
- [x] ë¡œê·¸ì¸ í˜ì´ì§€ UI ê°œì„ 
- [x] ë§ˆìŠ¤í„° ëŒ€ì‹œë³´ë“œ ì¸ì¦ ì—°ë™

### V1.0 (ê¸°ì¡´)
- [x] Zero-Touch Onboarding
- [x] Gemini 2.5 Flash AI ìƒë‹´
- [x] ì›í´ë¦­ AI ì…‹íŒ…
- [x] ë´‡ ê¸°ê°„ ê´€ë¦¬
- [x] ë§¤ì¥ ì‚­ì œ ê¸°ëŠ¥
- [x] í• ë£¨ì‹œë„¤ì´ì…˜ ê°€ë“œ

---

## ğŸš§ ì˜ˆì • ê¸°ëŠ¥ (Phase 3)

- [ ] Cron Triggers (ë¦¬ë§ˆì¸ë” ìë™ ë°œì†¡)
- [ ] ì‹¤ì‹œê°„ ëŒ€í™” ëª¨ë‹ˆí„°ë§ (WebSocket)
- [ ] 2ë‹¨ê³„ ì¸ì¦ (2FA)
- [ ] ë¹„ë°€ë²ˆí˜¸ ì°¾ê¸° (ì´ë©”ì¼ ì¸ì¦)
- [ ] ë„¤ì´ë²„ OAuth ìë™ ì—°ë™

---

## ğŸ”§ ê°œë°œ í™˜ê²½ ì„¤ì •

```bash
# 1. ì˜ì¡´ì„± ì„¤ì¹˜
npm install

# 2. ë¡œì»¬ D1 ë§ˆì´ê·¸ë ˆì´ì…˜
npx wrangler d1 migrations apply xivix-production --local

# 3. ë¹Œë“œ
npm run build

# 4. ê°œë°œ ì„œë²„ ì‹œì‘
pm2 start ecosystem.config.cjs

# 5. í…ŒìŠ¤íŠ¸
curl http://localhost:3000/api/system/health
```

---

## ğŸ“Š ì„±ëŠ¥ ì§€í‘œ

| ë©”íŠ¸ë¦­ | ëª©í‘œ | ì‹¤ì¸¡ |
|--------|------|------|
| ì²« í† í° ì‘ë‹µ | < 0.5s | ~0.4s |
| ì „ì²´ ì‘ë‹µ | < 3s | ~2s |
| ì˜ˆì•½ ì „í™˜ìœ¨ | > 25% | 66.7% |
| ì¸ì¦ ì‘ë‹µ | < 100ms | ~50ms |

---

## ğŸ”§ ê¸°ìˆ  ìŠ¤íƒ

| êµ¬ë¶„ | ê¸°ìˆ  |
|------|------|
| **AI Engine** | Gemini 2.5 Flash |
| **Runtime** | Cloudflare Workers (Hono Framework) |
| **Database** | Cloudflare D1 (SQLite) |
| **Cache** | Cloudflare KV |
| **Storage** | Cloudflare R2 |
| **Notification** | Solapi (KakaoTalk) |
| **Frontend** | TailwindCSS CDN + Vanilla JS |

---

## ğŸ“ ë¼ì´ì„ ìŠ¤

Â© 2026 XIVIX. All rights reserved.

---

**Last Updated**: 2026-02-02  
**Version**: 2.0.0 (Authentication + Reminder + Report)
